{"ast":null,"code":"var _jsxFileName = \"/Users/rajeevranjanpratapsingh/Downloads/tech2 weather app/frontend/src/context/UserContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport React, { createContext, useContext, useState, useEffect } from 'react';\nimport { useMutation } from '@apollo/client';\nimport { gql } from '@apollo/client';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CREATE_USER = gql`\n  mutation CreateUser($input: CreateUserInput!) {\n    createUser(input: $input) {\n      id\n      userId\n      email\n      name\n      created_at\n      last_login\n    }\n  }\n`;\nconst UPDATE_USER_LOGIN = gql`\n  mutation UpdateUserLogin($userId: String!) {\n    updateUserLogin(userId: $userId) {\n      id\n      userId\n      last_login\n    }\n  }\n`;\nconst UserContext = /*#__PURE__*/createContext();\nexport const useUser = () => {\n  _s();\n  const context = useContext(UserContext);\n  if (!context) {\n    throw new Error('useUser must be used within a UserProvider');\n  }\n  return context;\n};\n_s(useUser, \"b9L3QQ+jgeyIrH0NfHrJ8nn7VMU=\");\nexport const UserProvider = ({\n  children\n}) => {\n  _s2();\n  const [currentUser, setCurrentUser] = useState(null);\n  const [isLoading, setIsLoading] = useState(true);\n  const [createUserMutation] = useMutation(CREATE_USER);\n  const [updateUserLoginMutation] = useMutation(UPDATE_USER_LOGIN);\n\n  // Load user from localStorage on mount\n  useEffect(() => {\n    const storedUserId = localStorage.getItem('userId');\n    const storedEmail = localStorage.getItem('userEmail');\n    const storedName = localStorage.getItem('userName');\n    if (storedUserId) {\n      setCurrentUser({\n        userId: storedUserId,\n        email: storedEmail,\n        name: storedName\n      });\n\n      // Update last login\n      updateUserLoginMutation({\n        variables: {\n          userId: storedUserId\n        }\n      }).catch(err => console.error('Failed to update login:', err));\n    }\n    setIsLoading(false);\n  }, [updateUserLoginMutation]);\n  const login = async (userId, email, name) => {\n    try {\n      // Try to update login (user exists)\n      const {\n        data\n      } = await updateUserLoginMutation({\n        variables: {\n          userId\n        }\n      });\n      const user = {\n        userId,\n        email,\n        name\n      };\n      setCurrentUser(user);\n      localStorage.setItem('userId', userId);\n      if (email) localStorage.setItem('userEmail', email);\n      if (name) localStorage.setItem('userName', name);\n      return {\n        success: true,\n        user\n      };\n    } catch (error) {\n      // If user doesn't exist, create new user\n      if (error.message.includes('User not found')) {\n        try {\n          const {\n            data\n          } = await createUserMutation({\n            variables: {\n              input: {\n                userId,\n                email,\n                name\n              }\n            }\n          });\n          const user = data.createUser;\n          setCurrentUser({\n            userId: user.userId,\n            email: user.email,\n            name: user.name\n          });\n          localStorage.setItem('userId', user.userId);\n          if (user.email) localStorage.setItem('userEmail', user.email);\n          if (user.name) localStorage.setItem('userName', user.name);\n          return {\n            success: true,\n            user,\n            isNewUser: true\n          };\n        } catch (createError) {\n          return {\n            success: false,\n            error: createError.message\n          };\n        }\n      }\n      return {\n        success: false,\n        error: error.message\n      };\n    }\n  };\n  const logout = () => {\n    setCurrentUser(null);\n    localStorage.removeItem('userId');\n    localStorage.removeItem('userEmail');\n    localStorage.removeItem('userName');\n  };\n  const value = {\n    currentUser,\n    isLoading,\n    login,\n    logout,\n    isAuthenticated: !!currentUser\n  };\n  return /*#__PURE__*/_jsxDEV(UserContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 127,\n    columnNumber: 10\n  }, this);\n};\n_s2(UserProvider, \"x175BI6Nbcn6D8RmqgjpP39J0H8=\", false, function () {\n  return [useMutation, useMutation];\n});\n_c = UserProvider;\nvar _c;\n$RefreshReg$(_c, \"UserProvider\");","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","useMutation","gql","jsxDEV","_jsxDEV","CREATE_USER","UPDATE_USER_LOGIN","UserContext","useUser","_s","context","Error","UserProvider","children","_s2","currentUser","setCurrentUser","isLoading","setIsLoading","createUserMutation","updateUserLoginMutation","storedUserId","localStorage","getItem","storedEmail","storedName","userId","email","name","variables","catch","err","console","error","login","data","user","setItem","success","message","includes","input","createUser","isNewUser","createError","logout","removeItem","value","isAuthenticated","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["/Users/rajeevranjanpratapsingh/Downloads/tech2 weather app/frontend/src/context/UserContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\nimport { useMutation } from '@apollo/client';\nimport { gql } from '@apollo/client';\n\nconst CREATE_USER = gql`\n  mutation CreateUser($input: CreateUserInput!) {\n    createUser(input: $input) {\n      id\n      userId\n      email\n      name\n      created_at\n      last_login\n    }\n  }\n`;\n\nconst UPDATE_USER_LOGIN = gql`\n  mutation UpdateUserLogin($userId: String!) {\n    updateUserLogin(userId: $userId) {\n      id\n      userId\n      last_login\n    }\n  }\n`;\n\nconst UserContext = createContext();\n\nexport const useUser = () => {\n  const context = useContext(UserContext);\n  if (!context) {\n    throw new Error('useUser must be used within a UserProvider');\n  }\n  return context;\n};\n\nexport const UserProvider = ({ children }) => {\n  const [currentUser, setCurrentUser] = useState(null);\n  const [isLoading, setIsLoading] = useState(true);\n\n  const [createUserMutation] = useMutation(CREATE_USER);\n  const [updateUserLoginMutation] = useMutation(UPDATE_USER_LOGIN);\n\n  // Load user from localStorage on mount\n  useEffect(() => {\n    const storedUserId = localStorage.getItem('userId');\n    const storedEmail = localStorage.getItem('userEmail');\n    const storedName = localStorage.getItem('userName');\n\n    if (storedUserId) {\n      setCurrentUser({\n        userId: storedUserId,\n        email: storedEmail,\n        name: storedName\n      });\n\n      // Update last login\n      updateUserLoginMutation({ \n        variables: { userId: storedUserId } \n      }).catch(err => console.error('Failed to update login:', err));\n    }\n\n    setIsLoading(false);\n  }, [updateUserLoginMutation]);\n\n  const login = async (userId, email, name) => {\n    try {\n      // Try to update login (user exists)\n      const { data } = await updateUserLoginMutation({ \n        variables: { userId } \n      });\n\n      const user = { userId, email, name };\n      setCurrentUser(user);\n      localStorage.setItem('userId', userId);\n      if (email) localStorage.setItem('userEmail', email);\n      if (name) localStorage.setItem('userName', name);\n\n      return { success: true, user };\n    } catch (error) {\n      // If user doesn't exist, create new user\n      if (error.message.includes('User not found')) {\n        try {\n          const { data } = await createUserMutation({\n            variables: {\n              input: { userId, email, name }\n            }\n          });\n\n          const user = data.createUser;\n          setCurrentUser({\n            userId: user.userId,\n            email: user.email,\n            name: user.name\n          });\n\n          localStorage.setItem('userId', user.userId);\n          if (user.email) localStorage.setItem('userEmail', user.email);\n          if (user.name) localStorage.setItem('userName', user.name);\n\n          return { success: true, user, isNewUser: true };\n        } catch (createError) {\n          return { success: false, error: createError.message };\n        }\n      }\n\n      return { success: false, error: error.message };\n    }\n  };\n\n  const logout = () => {\n    setCurrentUser(null);\n    localStorage.removeItem('userId');\n    localStorage.removeItem('userEmail');\n    localStorage.removeItem('userName');\n  };\n\n  const value = {\n    currentUser,\n    isLoading,\n    login,\n    logout,\n    isAuthenticated: !!currentUser\n  };\n\n  return <UserContext.Provider value={value}>{children}</UserContext.Provider>;\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}